Extra Credit for Offsec - crypto challenge

Leaked RSA

GOAL: Use `rsa_encrypt.py` output to decrypt the ciphertext.

`rsa_encrypt.py`:

```
from Cryptodome.Util.number import *

p = getPrime(1024)
q = getPrime(1024)

N = p * q
e = 65537

f = (p+q) * q + 1

phi = (p-1) * (q-1)

c = pow(bytes_to_long(b'flag{???}'), e, N)

print("N: ",N)
print("f: ",f)
print("C: ",C)
```

`out.txt`:

```
N:  16869774719794592796016645140992091102472453147801739625108640767061987401578359729334758186700002920695794615867758269263067935245815900887581411745723962854888371564215602530375676233702110821497475916192581061644007358952863072245068298515075072424021478784750114727896239493022406455510901034838794780846955041384649687667718148793527692993508809054519490435975056677714747266543026662679537827403928034559455790054870489241578414220589572605564770520592869472024287643061816460327352516707212685298381200802508127133445426211901597995008131405463748729372463979778492332588002100785771535067459377985407765109759
f:  28794471208737220397452315068798074332464844306538514127322067483349208672437997254597091723737290922329987187197234895600664338357331142521912903626573300953288008655991095476077462807723107088192379967452382130165648448962024277838867910976930559005512825318857812863479899296181270190395077730653383252130287473738709820546278566058573529984185673505388050766657367606715757679903329413980966596508638162201152270800606926997006576165122469532895219829111192481211633871660223974839441921135060710538374632374024494526485576373055456186001102465334712461320523816446951732958815225803376142411726044988693340495681
C:  1371386897082421619315922850273607223364969244719522626376806848234353654447403104572133531617795563509509217034375700458296591559278797128892437978064981657690100178681239975479786050077657949653943738729402795341863173270426202887521341775543331524226349605020295064215132566519394533879034504732200137234865656201083418115985149892523287215009139613046328689461510721625880031578182620740402021117286958628622461830010173167148520830659353434522579198476975381566462445751671997947740299339347220808116370041640023815471850121217970557068256755145418998781525256662131332596654514420718569293830033494212203190452
```

From the source code, we can see `f = (p+q)*q + 1 = q^2 + p*q + 1 = q^2 + N + 1`, meaning 
that `f - (N+1) = q^2`. We can use this to obtain `q`, then use the result to get 
`p = N / q`.

`f - (N+1) = 11924696488942627601435669927805983229992391158736774502213426716287221270859637525262333537037288001634192571329476626337596403111515241634331491880849338098399637091775492945701786574020996266694904051259801068521641090009161205593799612461855486581491346534107698135583659803158863734884176695814588471283332432354060132878560417265045836990676864450868560330682310929001010413360302751301428769104710127641696480745736437755428161944532896927330449308518323009187346228598407514512089404427848025239993431571516367393040150161153858190992971059870963731948059836668459400370813125017604607344266667003285575385921`

`q = sqrt(f - (N+1)) = 109200258648698390349160476737217071803754426679817393201273802928168933999437969808189214107016576979296215291024498601297679570559997948193762913435398523030631753321429378995065778044095451169581283218597701565737539787168339486317167909545092029820034856648502474174162413542853233645762380683526136098911` from [here](https://www.calculator.net/root-calculator.html)

`p = N / q = 154484750572481099505796116595574215024713132075316430774471950820504414016168644975482994539976573070359642683206035224651982567589256456361494552529061143038904173852205483981871336952692229581016360676672991544700436767684470054695982829370100323108625785627618002259978652796681885065751299549821505615969` from [here](https://www.calculator.net/big-number-calculator.html)

We can now use [this website](https://www.dcode.fr/rsa-cipher) with the variables
we calculated to obtain the ciphertext `m`.

`m = decrypt_rsa(p,q,e,C) = 10786438895797657956050413501846839398590122102813143676564437755005`

`pt = long_to_bytes(m).decode()` 

Flag: `flag{br0k3n_r5a_15_n0t_g00d}`
